# Emotet Malware Analysis

## Rule of Thumb for Emotet Malware Attack

When analyzing Emotet malware attacks, consider the following indicators of compromise (IOCs):

1. **Email Indicators**:
    - Suspicious email attachments (e.g., .doc, .xls, .zip files).
    - Emails with unusual or unexpected content.
    - Emails from known contacts with unusual language or requests.

2. **Network Indicators**:
    - Unusual outbound traffic, especially to known malicious IP addresses.
    - Connections to command and control (C2) servers.
    - High volume of traffic on ports commonly used by Emotet (e.g., 80, 443).

3. **File System Indicators**:
    - Presence of Emotet-related files in temporary directories.
    - Unusual file modifications or new files in system directories.
    - Suspicious executable files with random names.

4. **Behavioral Indicators**:
    - Unexpected system behavior, such as slow performance or crashes.
    - Unauthorized access attempts or privilege escalation.
    - Unusual processes running in the background.

## Analyzing Emotet Attacks Using SPL (Search Processing Language)

To analyze Emotet attacks using SPL in a SIEM tool like Splunk, you can use the following queries:

### 1. Detecting Suspicious Email Attachments
```bash
index=email sourcetype="sendmail" 
| search attachment="*.doc" OR attachment="*.xls" OR attachment="*.zip"
| stats count by sender, recipient, attachment
```

### 2. Identifying Unusual Outbound Traffic
```bash
index=network sourcetype="stream:http" 
| search dest_port=80 OR dest_port=443
| stats count by src_ip, dest_ip, dest_port
| where count > threshold
```

### 3. Finding Connections to Known Malicious IPs
```bash
index=network sourcetype="stream:tcp" 
| lookup malicious_ips.csv ip AS dest_ip OUTPUTNEW description
| search description="Emotet C2"
| stats count by src_ip, dest_ip
```

### 4. Detecting Suspicious File Modifications
```bash
index=filesystem sourcetype="fschange" 
| search path="C:\\Windows\\Temp\\*" OR path="C:\\Users\\*\\AppData\\Local\\Temp\\*"
| stats count by host, path
```

### 5. Monitoring Unusual Processes
```bash
index=os sourcetype="ps" 
| search process_name="*.exe" 
| stats count by host, process_name
| where count > threshold
```

These queries can help you identify and analyze potential Emotet malware activities in your network.
